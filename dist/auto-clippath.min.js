/* 
auto-clippath v1.0.1 
The TypeScript-based library for clip-path generation
https://github.com/rjct/auto-clippath
Copyright (c) 2023-present, Eugene Shordukalo <info@reject.in.ua>   
*/
async function C(e,a,r){let{width:n,height:o}=a,t=r&&"shift"in r&&r.shift!==void 0?r.shift:{x:0,y:0},i=r&&"gap"in r&&r.gap!==void 0?r.gap:0,s=r&&"distance"in r&&r.distance!==void 0?r.distance:1/0,u=performance.now(),d=new OffscreenCanvas(n,o).getContext("2d");try{return d.drawImage(e,-t.x,-t.y,n,o,0,0,n,o),new Promise(h=>{h({clipPath:w(d.getImageData(0,0,n,o),i,s),time:performance.now()-u})})}catch(h){throw new Error(h)}}function g(e){if(e.length<=3)return e;let a=(o,t,i)=>{let s=(t.y-o.y)*(i.x-t.x)-(t.x-o.x)*(i.y-t.y);return s===0?0:s>0?1:2},r=(o,t)=>{let i=a(e[0],o,t);return i===0?Math.hypot(o.x-e[0].x,o.y-e[0].y)-Math.hypot(t.x-e[0].x,t.y-e[0].y):i===2?-1:1};e.sort(r);let n=[];n.push(e[0]);for(let o=2;o<e.length;o++){let t=n.length-1;for(;t>=1&&a(n[t-1],n[t],e[o])!==2;)n.pop(),t=n.length-1;n.push(e[o])}return n}function m(e,a,r){return(a.x-e.x)*(r.y-e.y)-(a.y-e.y)*(r.x-e.x)}function b(e,a){return Math.sqrt((a.x-e.x)**2+(a.y-e.y)**2)}function P(e,a,r){let n=[];function o(t){(n.length===0||b(t,n[n.length-1])>r)&&n.push({x:Math.round(t.x),y:Math.round(t.y)})}for(let t=0;t<e.length;t++){let i=e[t],s=e[(t+1)%e.length],u=s.x-i.x,c=s.y-i.y,d=Math.sqrt(u*u+c*c),h=u/d,f=c/d,y={x:i.x+f*a,y:i.y-h*a},l={x:s.x+f*a,y:s.y-h*a};o(y);let x=n.length;for(;x>=2&&m(n[x-2],n[x-1],l)<=0;)n.pop(),x--;t!==e.length-1&&o(l)}return n}function w(e,a,r){let{width:n,height:o,data:t}=e,i=(c,d)=>t[(d*n+c)*4+3]>1,s=[];for(let c=0;c<o;c++)for(let d=0;d<n;d++)i(d,c)&&s.push({x:d,y:c});let u=g(s);return P(u,a,r)}export{C as default};
//# sourceMappingURL=auto-clippath.min.js.map
