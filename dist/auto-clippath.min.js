/* 
auto-clippath v1.0.0 
The TypeScript-based library for 
https://github.com/rjct/auto-clippath
Licensed GPLv3 for open source use, or Commercial License for commercial use - https://github.com/mzusin/index/blob/main/LICENSE.md    
Copyright (c) 2023-present, Ievgen Shordukalo <info@reject.in.ua>   
*/
(()=>{var x=Math.pow;var f=(t,a,o)=>new Promise((n,r)=>{var e=c=>{try{s(o.next(c))}catch(d){r(d)}},i=c=>{try{s(o.throw(c))}catch(d){r(d)}},s=c=>c.done?n(c.value):Promise.resolve(c.value).then(e,i);s((o=o.apply(t,a)).next())});function g(t,a,o){return f(this,null,function*(){let{width:n,height:r}=a,e=o&&"shift"in o?o.shift:{x:0,y:0},i=o&&"gap"in o?o.gap:0,s=o&&"distance"in o?o.distance:1/0,c=performance.now(),u=new OffscreenCanvas(n,r).getContext("2d");try{return u.drawImage(t,-e.x,-e.y,n,r,0,0,n,r),new Promise(h=>{h({clipPath:M(u.getImageData(0,0,n,r),i,s),time:performance.now()-c})})}catch(h){throw new Error(h)}})}function P(t){if(t.length<=3)return t;let a=(r,e,i)=>{let s=(e.y-r.y)*(i.x-e.x)-(e.x-r.x)*(i.y-e.y);return s===0?0:s>0?1:2},o=(r,e)=>{let i=a(t[0],r,e);return i===0?Math.hypot(r.x-t[0].x,r.y-t[0].y)-Math.hypot(e.x-t[0].x,e.y-t[0].y):i===2?-1:1};t.sort(o);let n=[];n.push(t[0]);for(let r=2;r<t.length;r++){let e=n.length-1;for(;e>=1&&a(n[e-1],n[e],t[r])!==2;)n.pop(),e=n.length-1;n.push(t[r])}return n}function b(t,a,o){return(a.x-t.x)*(o.y-t.y)-(a.y-t.y)*(o.x-t.x)}function w(t,a){return Math.sqrt(x(a.x-t.x,2)+x(a.y-t.y,2))}function p(t,a,o){let n=[];function r(e){(n.length===0||w(e,n[n.length-1])>o)&&n.push({x:Math.round(e.x),y:Math.round(e.y)})}for(let e=0;e<t.length;e++){let i=t[e],s=t[(e+1)%t.length],c=s.x-i.x,d=s.y-i.y,u=Math.sqrt(c*c+d*d),h=c/u,C=d/u,m={x:i.x+C*a,y:i.y-h*a},y={x:s.x+C*a,y:s.y-h*a};r(m);let l=n.length;for(;l>=2&&b(n[l-2],n[l-1],y)<=0;)n.pop(),l--;e!==t.length-1&&r(y)}return n}function M(t,a,o){let{width:n,height:r,data:e}=t,i=(d,u)=>e[(u*n+d)*4+3]>1,s=[];for(let d=0;d<r;d++)for(let u=0;u<n;u++)i(u,d)&&s.push({x:u,y:d});let c=P(s);return p(c,a,o)}window.autoClipPath=window.autoClipPath||g;})();
//# sourceMappingURL=auto-clippath.min.js.map
